var fs=require("fs"),path=require("path"),peer=require("./peer-server.js"),port=process.env.PORT||5e3,http=require("http"),root=__dirname.match(/[a-z]+$/)[0],app=http.createServer(function(e,t){var n="."+e.url;"./"==n&&(n="./index.html"),n=root+"/"+n,console.log("request starting: "+n);var r=path.extname(n),o="text/html";switch(r){case".js":o="text/javascript";break;case".css":o="text/css";break;case".png":o="image/png"}path.exists(n,function(e){return e?(fs.readFile(n,function(e,n){return e?(t.writeHead(500),t.end(),void 0):(t.writeHead(200,{"Content-Type":o}),t.end(n,"utf-8"),void 0)}),void 0):(t.writeHead(404),t.end(),void 0)})}).listen(port);console.log(port),peer(app);